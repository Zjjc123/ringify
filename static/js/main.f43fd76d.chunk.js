(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{31:function(e,t,n){},68:function(e,t){},85:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(25),r=n.n(s),i=(n(31),n(0));function l(){return Object(i.jsx)("div",{className:"container mx-auto",children:Object(i.jsx)("div",{className:"flex justify-center my-12",children:Object(i.jsx)("a",{className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",href:"https://accounts.spotify.com/authorize?client_id=9149f32554f7425bac1191a602bb83e7&response_type=code&redirect_uri=https://zjjc123.github.io/ringify&scope=user-follow-read",children:"Login with Spotify"})})})}var o=n(3),u=n(11),d=n.n(u),f="/ringify";var j=n(26);function b(e){var t=e.album;return console.log(t.url),Object(i.jsxs)("a",{className:"w-full lg:max-w-full lg:flex my-16 shadow-md ",href:t.url,children:[Object(i.jsx)("img",{className:"lg:w-48 w-full flex-none object-cover rounded-t rounded-l overflow-hidden",alt:t.title,src:t.albumUrl}),Object(i.jsxs)("div",{className:"lg:rounded-r p-4 flex flex-col justify-between leading-normal",children:[Object(i.jsx)("div",{className:"mb-8",children:Object(i.jsx)("div",{className:"text-gray-900 font-bold text-3xl mb-2",children:t.title})}),Object(i.jsx)("div",{className:"flex items-center",children:Object(i.jsxs)("div",{className:"text-2xl",children:[Object(i.jsx)("p",{className:"text-gray-900 leading-none",children:t.artist}),Object(i.jsx)("p",{className:"text-gray-600",children:t.releaseDate})]})})]})]})}var h=new(n.n(j).a)({clientId:"9149f32554f7425bac1191a602bb83e7"});function x(e){var t=function(e){var t=Object(c.useState)(),n=Object(o.a)(t,2),a=n[0],s=n[1],r=Object(c.useState)(),i=Object(o.a)(r,2),l=i[0],u=i[1],j=Object(c.useState)(),b=Object(o.a)(j,2),h=b[0],x=b[1];return Object(c.useEffect)((function(){d.a.post("http://localhost:3001/login",{code:e}).then((function(e){s(e.data.accessToken),u(e.data.refreshToken),x(e.data.expiresIn),window.history.pushState({},null,f)})).catch((function(){window.location=f}))}),[e]),Object(c.useEffect)((function(){if(l&&h){var e=setInterval((function(){d.a.post("http://localhost:3001/refresh",{refreshToken:l}).then((function(e){s(e.data.accessToken),x(e.data.expiresIn)})).catch((function(){window.location=f}))}),1e3*(h-60));return function(){return clearInterval(e)}}}),[l,h]),a}(e.code),n=Object(c.useState)(),a=Object(o.a)(n,2),s=a[0],r=a[1];return Object(c.useEffect)((function(){t&&h.setAccessToken(t)}),[t]),Object(c.useEffect)((function(){if(t){var e=[];h.getFollowedArtists({limit:50}).then((function(t){return Promise.all(t.body.artists.items.map((function(t){return h.getArtistAlbums(t.id).then((function(t){t.body.items.forEach((function(t){var n=new Date(t.release_date);(Date.now()-n.getTime())/864e5<30&&e.push(t)}))}))})))})).then((function(){r(e.map((function(e){return{artist:e.artists[0].name,title:e.name,url:e.external_urls.spotify,albumUrl:e.images[0].url,releaseDate:e.release_date}})))}))}}),[t]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{className:"text-center text-5xl font-bold pt-16",children:"New Releases"}),Object(i.jsx)("div",{className:"justify-center h-screen w-full px-48 py-8",children:s?s.map((function(e){return Object(i.jsx)(b,{album:e})})):Object(i.jsx)("div",{})})]})}var m=new URLSearchParams(window.location.search).get("code");var O=function(){return m?Object(i.jsx)(x,{code:m}):Object(i.jsx)(l,{})};r.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(O,{})}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.f43fd76d.chunk.js.map