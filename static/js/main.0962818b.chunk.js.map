{"version":3,"sources":["pages/Login.js","hooks/useAuth.js","components/Album.js","pages/Dashboard.js","App.js","index.js"],"names":["Login","className","href","homePath","serverUrl","Album","album","console","log","url","alt","title","src","albumUrl","artist","releaseDate","spotifyApi","SpotifyWebApi","clientId","Dashboard","accessToken","code","useState","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","useEffect","axios","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval","useAuth","albums","setAlbums","newAlbums","getFollowedArtists","limit","Promise","all","body","artists","items","map","getArtistAlbums","id","forEach","dateReleased","Date","release_date","now","getTime","push","name","external_urls","spotify","images","URLSearchParams","search","get","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.0962818b.chunk.js","sourcesContent":["import React from \"react\";\n\nconst AUTH_URL =\n    \"https://accounts.spotify.com/authorize?client_id=9149f32554f7425bac1191a602bb83e7&response_type=code&redirect_uri=https://zjjc123.github.io/ringify&scope=user-follow-read\";\n\nexport default function Login() {\n    return (\n        <div className=\"container mx-auto\">\n            <div className=\"flex justify-center my-12\">\n                <a\n                    className=\"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded\"\n                    href={AUTH_URL}\n                >\n                    Login with Spotify\n                </a>\n            </div>\n        </div>\n    );\n}\n","import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nconst homePath = \"/ringify\";\nconst serverUrl = \"https://ringify.herokuapp.com\";\n\nexport default function useAuth(code) {\n    const [accessToken, setAccessToken] = useState();\n    const [refreshToken, setRefreshToken] = useState();\n    const [expiresIn, setExpiresIn] = useState();\n\n    useEffect(() => {\n        axios\n            .post(serverUrl + \"/login\", {\n                code,\n            })\n            .then((res) => {\n                setAccessToken(res.data.accessToken);\n                setRefreshToken(res.data.refreshToken);\n                setExpiresIn(res.data.expiresIn);\n                window.history.pushState({}, null, homePath);\n            })\n            .catch(() => {\n                window.location = homePath;\n            });\n    }, [code]);\n\n    useEffect(() => {\n        if (!refreshToken || !expiresIn) return;\n        const interval = setInterval(() => {\n            axios\n                .post(serverUrl + \"refresh\", {\n                    refreshToken,\n                })\n                .then((res) => {\n                    setAccessToken(res.data.accessToken);\n                    setExpiresIn(res.data.expiresIn);\n                })\n                .catch(() => {\n                    window.location = homePath;\n                });\n        }, (expiresIn - 60) * 1000);\n        return () => clearInterval(interval);\n    }, [refreshToken, expiresIn]);\n\n    return accessToken;\n}\n","import React from \"react\";\n\nexport default function Album({ album }) {\n    console.log(album.url);\n    return (\n        <a\n            className=\"w-full lg:max-w-full lg:flex my-16 shadow-md \"\n            href={album.url}\n        >\n            <img\n                className=\"lg:w-48 w-full flex-none object-cover rounded-t rounded-l overflow-hidden\"\n                alt={album.title}\n                src={album.albumUrl}\n            ></img>\n            <div className=\"lg:rounded-r p-4 flex flex-col justify-between leading-normal\">\n                <div className=\"mb-8\">\n                    <div className=\"text-gray-900 font-bold text-3xl mb-2\">\n                        {album.title}\n                    </div>\n                </div>\n                <div className=\"flex items-center\">\n                    <div className=\"text-2xl\">\n                        <p className=\"text-gray-900 leading-none\">\n                            {album.artist}\n                        </p>\n                        <p className=\"text-gray-600\">{album.releaseDate}</p>\n                    </div>\n                </div>\n            </div>\n        </a>\n    );\n}\n","import React, { useState, useEffect } from \"react\";\nimport useAuth from \"../hooks/useAuth\";\n\nimport SpotifyWebApi from \"spotify-web-api-node\";\nimport Album from \"../components/Album\";\n\nconst spotifyApi = new SpotifyWebApi({\n    clientId: \"9149f32554f7425bac1191a602bb83e7\",\n});\n\nexport default function Dashboard({ code }) {\n    const accessToken = useAuth(code);\n    const [albums, setAlbums] = useState();\n\n    useEffect(() => {\n        if (!accessToken) return;\n        spotifyApi.setAccessToken(accessToken);\n    }, [accessToken]);\n\n    useEffect(() => {\n        if (!accessToken) return;\n        var newAlbums = [];\n        spotifyApi\n            .getFollowedArtists({ limit: 50 })\n            .then((data) => {\n                // for each followed artist\n                return Promise.all(\n                    data.body.artists.items.map((artist) => {\n                        return spotifyApi\n                            .getArtistAlbums(artist.id)\n                            .then((data) => {\n                                // for each album by that artist\n                                data.body.items.forEach((album) => {\n                                    const dateReleased = new Date(\n                                        album.release_date\n                                    );\n                                    const timeDifference =\n                                        Date.now() - dateReleased.getTime();\n                                    const dayDifference =\n                                        timeDifference / (1000 * 3600 * 24);\n\n                                    if (dayDifference < 30) {\n                                        newAlbums.push(album);\n                                    }\n                                });\n                            });\n                    })\n                );\n            })\n            .then(() => {\n                setAlbums(\n                    newAlbums.map((album) => {\n                        return {\n                            artist: album.artists[0].name,\n                            title: album.name,\n                            url: album.external_urls.spotify,\n                            albumUrl: album.images[0].url,\n                            releaseDate: album.release_date,\n                        };\n                    })\n                );\n            });\n    }, [accessToken]);\n\n    return (\n        <div>\n            <h1 className=\"text-center text-5xl font-bold pt-16\">\n                New Releases\n            </h1>\n            <div className=\"justify-center h-screen w-full px-48 py-8\">\n                {albums ? (\n                    albums.map((album) => <Album album={album} />)\n                ) : (\n                    <div />\n                )}\n            </div>\n        </div>\n    );\n}\n","import Login from \"./pages/Login\";\nimport Dashboard from \"./pages/Dashboard\";\n\nconst code = new URLSearchParams(window.location.search).get(\"code\");\n\nfunction App() {\n    return code ? <Dashboard code={code} /> : <Login />;\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n);\n"],"sourceRoot":""}