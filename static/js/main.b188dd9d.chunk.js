(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{31:function(e,t,n){},68:function(e,t){},85:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(25),r=n.n(a),i=(n(31),n(0));function l(){return Object(i.jsxs)("div",{className:"container mx-auto",children:[Object(i.jsxs)("div",{className:"flex flex-col justify-center items-center my-12 text-center",children:[Object(i.jsx)("h1",{className:"flex text-5xl text-center",children:"Get a collection of new releases from artists you follow"}),Object(i.jsx)("a",{className:"bg-green-500 hover:bg-green-700 text-white font-bold py-3 px-4 my-8 rounded",href:"https://accounts.spotify.com/authorize?client_id=9149f32554f7425bac1191a602bb83e7&response_type=code&redirect_uri=https://zjjc123.github.io/ringify&scope=user-follow-read",children:"Login with Spotify"})]}),Object(i.jsx)("footer",{class:"fixed bottom-0 right-0 m-2 text-sm",children:"Jason Zhang 2021"})]})}var o=n(3),u=n(11),f=n.n(u),d="/ringify",j="https://ringify.herokuapp.com";var b=n(26);function x(e){var t=e.album;return console.log(t.url),Object(i.jsxs)("a",{className:"w-full lg:max-w-full lg:flex my-16 shadow-md ",href:t.url,children:[Object(i.jsx)("img",{className:"lg:w-48 w-full flex-none object-cover rounded-t rounded-l overflow-hidden",alt:t.title,src:t.albumUrl}),Object(i.jsxs)("div",{className:"lg:rounded-r p-4 flex flex-col justify-between leading-normal",children:[Object(i.jsx)("div",{className:"mb-8",children:Object(i.jsx)("div",{className:"text-gray-900 font-bold text-lg lg:text-2xl mb-2",children:t.title})}),Object(i.jsx)("div",{className:"flex items-center",children:Object(i.jsxs)("div",{className:"text-md lg:text-xl",children:[Object(i.jsx)("p",{className:"text-gray-900 leading-none",children:t.artist}),Object(i.jsx)("p",{className:"text-gray-600",children:t.releaseDate})]})})]})]})}var m=new(n.n(b).a)({clientId:"9149f32554f7425bac1191a602bb83e7"});function h(e){var t=function(e){var t=Object(c.useState)(),n=Object(o.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(),i=Object(o.a)(r,2),l=i[0],u=i[1],b=Object(c.useState)(),x=Object(o.a)(b,2),m=x[0],h=x[1];return Object(c.useEffect)((function(){f.a.post(j+"/login",{code:e}).then((function(e){a(e.data.accessToken),u(e.data.refreshToken),h(e.data.expiresIn),window.history.pushState({},null,d)})).catch((function(){window.location=d}))}),[e]),Object(c.useEffect)((function(){if(l&&m){var e=setInterval((function(){f.a.post(j+"/refresh",{refreshToken:l}).then((function(e){a(e.data.accessToken),h(e.data.expiresIn)})).catch((function(){window.location=d}))}),1e3*(m-60));return function(){return clearInterval(e)}}}),[l,m]),s}(e.code),n=Object(c.useState)(),s=Object(o.a)(n,2),a=s[0],r=s[1];return Object(c.useEffect)((function(){t&&m.setAccessToken(t)}),[t]),Object(c.useEffect)((function(){if(t){var e=[];m.getFollowedArtists({limit:50}).then((function(t){return Promise.all(t.body.artists.items.map((function(t){return m.getArtistAlbums(t.id).then((function(t){t.body.items.forEach((function(t){var n=new Date(t.release_date);(Date.now()-n.getTime())/864e5<30&&e.push(t)}))}))})))})).then((function(){var t=e.map((function(e){return{artist:e.artists[0].name,title:e.name,url:e.external_urls.spotify,albumUrl:e.images[0].url,releaseDate:e.release_date}}));r(t.sort((function(e,t){return new Date(t.releaseDate).getTime()-new Date(e.releaseDate).getTime()})))}))}}),[t]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h1",{className:"text-center text-5xl font-bold pt-16 pb-4",children:"New Releases"}),Object(i.jsx)("div",{className:"justify-center h-screen w-full px-8 lg:px-48 py-3 lg:py-8",children:a?a.map((function(e){return Object(i.jsx)(x,{album:e})})):Object(i.jsx)("div",{})})]})}var g=new URLSearchParams(window.location.search).get("code");var p=function(){return g?Object(i.jsx)(h,{code:g}):Object(i.jsx)(l,{})};r.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(p,{})}),document.getElementById("root"))}},[[85,1,2]]]);
//# sourceMappingURL=main.b188dd9d.chunk.js.map